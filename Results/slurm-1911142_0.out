Traceback (most recent call last):
  File "main.py", line 243, in <module>
    main(sys.argv[1:])
  File "main.py", line 209, in main
    regret_train, best_found_train, treatment_classification_acc_train = get_metrics(train_X, train_real, train_t, branching, treatments, tree)
  File "main.py", line 54, in get_metrics
    diff, optimal, treat = datapoint_tree(1, i, test_X, test_real, test_t, branching, treatments, tree)
  File "main.py", line 45, in datapoint_tree
    return datapoint_tree(tree.get_left_children(node), i, test_X, test_real, test_t, branching, treatments, tree)
  File "main.py", line 44, in datapoint_tree
    if test_X.iloc[i, branching[node]] <= 0:  # go left (node 2)
KeyError: 2
['-f', 'data_train_enc_0.1_1.csv', '-e', 'data_test_enc_0.1_1.csv', '-d', '2', '-t', '3600', '-b', '100', '-r', 'kallus', '-n', '0', '-g', 'Athey_v1_500']
Using license file /spack/apps/linux-centos7-x86_64/gcc-8.3.0/gurobi-9.0.1/license/gurobi.lic
Set parameter TokenServer to value hpc-licenses.hpcc.usc.edu
Changed value of parameter TimeLimit to 3600.0
   Prev: inf  Min: 0.0  Max: inf  Default: inf
Gurobi Optimizer version 9.0.1 build v9.0.1rc0 (linux64)
Optimize a model with 13531 rows, 5572 columns and 53289 nonzeros
Model fingerprint: 0xe4163b1b
Variable types: 4004 continuous, 1568 integer (1568 binary)
Coefficient statistics:
  Matrix range     [2e-02, 3e+02]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 3e+02]
Presolve removed 1368 rows and 1270 columns
Presolve time: 0.19s
Presolved: 12163 rows, 4302 columns, 38562 nonzeros
Variable types: 3956 continuous, 346 integer (346 binary)
Found heuristic solution: objective 241.3890191
Found heuristic solution: objective 249.4064767

Root relaxation: objective 9.445848e+02, 8005 iterations, 1.12 seconds

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  944.58477    0  274  249.40648  944.58477   279%     -    1s
H    0     0                     249.8748115  944.58477   278%     -    1s
     0     0  834.07938    0  298  249.87481  834.07938   234%     -    3s
     0     0  834.07938    0  274  249.87481  834.07938   234%     -    3s
H    0     0                     267.2554066  834.07938   212%     -    3s
     0     0  589.50000    0  271  267.25541  589.50000   121%     -    4s
H    0     0                     269.6006881  589.50000   119%     -    5s
H    0     0                     273.2633607  589.50000   116%     -    5s
     0     0  538.63530    0  128  273.26336  538.63530  97.1%     -    5s
H    0     0                     273.3537870  538.63530  97.0%     -    6s
     0     0  520.65000    0  218  273.35379  520.65000  90.5%     -    6s
     0     0  520.25000    0  210  273.35379  520.25000  90.3%     -    6s
     0     0  518.75000    0  282  273.35379  518.75000  89.8%     -    7s
     0     0  518.75000    0  281  273.35379  518.75000  89.8%     -    7s
     0     0  517.50000    0  145  273.35379  517.50000  89.3%     -    7s
     0     0  517.50000    0  145  273.35379  517.50000  89.3%     -    7s
     0     0  517.00000    0  217  273.35379  517.00000  89.1%     -    8s
     0     0  517.00000    0   95  273.35379  517.00000  89.1%     -    9s
     0     2  517.00000    0   95  273.35379  517.00000  89.1%     -   11s
H   53    72                     278.5570908  500.06693  79.5%   129   14s
H   66    72                     280.5935782  500.06693  78.2%   163   14s
H   66    72                     283.4769162  500.06693  76.4%   163   14s
    71    92  500.00000    7  116  283.47692  500.06693  76.4%   176   15s
   111   129  490.15632    9  154  283.47692  500.06693  76.4%   194   21s
H  113   129                     284.0349503  500.06693  76.1%   194   21s
H  126   129                     284.8076557  500.06693  75.6%   189   21s
H  129   129                     285.7194574  500.06693  75.0%   186   21s
   305   242  443.87653   17  134  285.71946  500.06693  75.0%   151   25s
   615   375  324.25573   23   42  285.71946  500.06693  75.0%   144   31s
   855   460  312.31175    9  142  285.71946  500.00000  75.0%   141   35s
* 1053   523              24     288.6979114  500.00000  73.2%   133   37s
  1249   593  301.51813    9   53  288.69791  500.00000  73.2%   133   40s
  1575   703  478.94326    8  242  288.69791  500.00000  73.2%   133   46s
H 1750   747                     290.5613860  500.00000  72.1%   133   48s
  1820   782  410.10921   14  100  290.56139  500.00000  72.1%   132   50s
H 2352   962                     290.5614009  499.67748  72.0%   131   64s
H 2390   962                     291.5997270  499.67748  71.4%   131   64s
  2400  1002  296.09906   20   13  291.59973  493.66071  69.3%   132   65s
  3201  1188  365.99149   14  103  291.59973  477.37740  63.7%   127   70s
  3991  1430  430.38763   11  172  291.59973  460.99954  58.1%   124   76s
  5105  1668     cutoff   18       291.59973  446.82472  53.2%   117   81s
* 5743  1761              18     292.5137400  443.08913  51.5%   115   84s
  6094  1843  411.83796   18  101  292.51374  436.51442  49.2%   113   86s
H 6886  1953                     292.5137400  425.93230  45.6%   110   89s
  7084  1997  329.04215   14  160  292.51374  425.50669  45.5%   110   92s
  7872  2089  381.34518   15   94  292.51374  422.74743  44.5%   108  101s
H 7883  2089                     292.5137486  422.74743  44.5%   108  101s
  8424  2211  393.80511   14  106  292.51375  420.34628  43.7%   107  105s
  9342  2313  394.92651   12  298  292.51375  413.95515  41.5%   105  122s
  9344  2314  302.09858   16  274  292.51375  413.95515  41.5%   105  128s
  9345  2315  370.04419   14  243  292.51375  413.95515  41.5%   105  133s
  9349  2318  391.37769   15  227  292.51375  413.95515  41.5%   105  135s
  9353  2320  349.79141   13  272  292.51375  413.95515  41.5%   105  141s
  9355  2322  391.00835   10  123  292.51375  413.95515  41.5%   105  145s
  9356  2325  413.95515   14  181  292.51375  413.95515  41.5%   106  155s
  9362  2335  413.95515   16  196  292.51375  413.95515  41.5%   106  169s
  9370  2349  391.02251   17   85  292.51375  413.95515  41.5%   106  188s
  9386  2363  389.88682   18   88  292.51375  413.95515  41.5%   106  190s
  9446  2401  366.18333   20   92  292.51375  413.95515  41.5%   107  195s
H 9448  2284                     292.5137498  413.95515  41.5%   107  195s
H 9465  2168                     292.5137841  413.95515  41.5%   107  195s
  9500  2207  369.99172   21    1  292.51378  413.95515  41.5%   108  201s
H 9513  2098                     292.5157802  413.95515  41.5%   108  201s
  9899  2216  346.01570   22  141  292.51578  413.95515  41.5%   107  205s
 10612  2272  307.57370   32   52  292.51578  413.95515  41.5%   105  210s
 11139  2257  344.01561   26   91  292.51578  413.95515  41.5%   104  215s
 12177  2212  293.96330   25   11  292.51578  413.95515  41.5%   101  220s
 13186  2157  314.25199   23  113  292.51578  413.95515  41.5%  98.8  225s
 14523  2019  316.63060   25  119  292.51578  413.95515  41.5%  96.0  230s
 15525  1940  309.17183   26  104  292.51578  409.04402  39.8%  94.6  235s
 16927  2241  300.24572   32   61  292.51578  402.16028  37.5%  92.4  241s
 18153  2428  341.56415   32  101  292.51578  394.67301  34.9%  90.4  245s
 19648  2599  305.71176   29   32  292.51578  388.44303  32.8%  88.0  253s
 19917  2653  349.86779   27   81  292.51578  388.44303  32.8%  87.7  255s
 21408  2870  303.26334   35   32  292.51578  381.40398  30.4%  86.2  260s
 22458  2924     cutoff   30       292.51578  379.99230  29.9%  85.3  270s
 23134  3107  302.74505   35   33  292.51578  377.50603  29.1%  84.7  276s
 24370  3237  308.33787   24   93  292.51578  374.48564  28.0%  83.7  281s
 25747  3340  333.17478   27   90  292.51578  372.35626  27.3%  82.5  286s
 26518  3397  321.28337   30   62  292.51578  370.73704  26.7%  82.0  290s
 27772  3442  297.97994   31   78  292.51578  367.65797  25.7%  81.3  296s
 28579  3497  310.59518   32   94  292.51578  365.97277  25.1%  80.9  300s
 30266  3496  323.42476   30   42  292.51578  364.41602  24.6%  80.2  306s
 31877  3413  300.22804   30   31  292.51578  359.12669  22.8%  79.8  313s
 32819  3341  352.39220   28   92  292.51578  357.57620  22.2%  79.5  317s
 33771  3248  325.20569   27   93  292.51578  354.86364  21.3%  79.3  321s
 34873  3185     cutoff   33       292.51578  352.51156  20.5%  79.0  325s
 37116  2853  295.32420   28   94  292.51578  345.76474  18.2%  78.1  334s
 38371  2635  309.93557   22   12  292.51578  341.50426  16.7%  77.7  338s
 39856  2317     cutoff   32       292.51578  337.13659  15.3%  77.0  343s
 41358  1999  303.53311   23   22  292.51578  332.93377  13.8%  76.3  347s
 42955  1925  302.41308   30   69  292.51578  328.43770  12.3%  75.6  368s
 43260  1368  293.31759   31   95  292.51578  327.90638  12.1%  75.5  373s
 45345   412     cutoff   26       292.51578  323.42616  10.6%  74.3  379s
 47889     0     cutoff   28       292.51578  308.22404  5.37%  72.5  381s

Cutting planes:
  Gomory: 48
  MIR: 486
  Flow cover: 2
  Inf proof: 1
  RLT: 706
  BQP: 23

Explored 48639 nodes (3508038 simplex iterations) in 381.22 seconds
Thread count was 20 (of 20 available processors)

Solution count 10: 292.516 291.6 290.561 ... 278.557

Optimal solution found (tolerance 1.00e-04)
Best objective 2.925157802270e+02, best bound 2.925157802270e+02, gap 0.0000%



#########node 1
V1.6
#########node 3
V1.4
#########node 4
leaf 1
#########node 5
leaf 1
#########node 6
leaf 1
#########node 7
leaf 0


Total Solving Time 382.47274708747864
obj value 292.51578022701256
